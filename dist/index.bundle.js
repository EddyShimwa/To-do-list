"use strict";(self.webpackChunkto_do_list=self.webpackChunkto_do_list||[]).push([[826],{808:(e,t,r)=>{function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!1,a="",s=(e=e.trim()).length;if(t&&e.length<=0)return{isError:i=!0,msg:a="This field is Required!"};if(r>0&&s<r)return{isError:i=!0,msg:a="The min character length of this field is ".concat(r)};if(n>0&&s>n)return{isError:i=!0,msg:a="The max character length of this field is ".concat(n)};if(!o){var c=e.replace(/\s/g,""),l=/^[A-Za-z][A-Za-z0-9-_.]*$/;if(!l.test(c))return{isError:i=!0,msg:a="This field is only allow A-z0-9_.- characters and also first character should be A-z"}}return{isError:i,msg:a}},i=document.getElementById("description"),a=document.querySelector(".display-message"),s=document.querySelector(".btn-submit"),c=document.querySelector(".group-todo-items"),l=(document.querySelectorAll(".todo-des"),document.querySelector(".btn-clear-all"));const d=r.p+"images/three-dot-24.png",u=r.p+"images/trash-24.png";function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function f(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function g(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y(e,t,r){return(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===m(t)?t:String(t)}var b=g((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,"sortAndSave",(function(){var e=f(t.todos);e.sort((function(e,t){return e.index>t.index?1:e.index<t.index?-1:0}));var r=0;e.forEach((function(e){r+=1,e.index=r})),t.todos=f(e),localStorage.setItem("todos",JSON.stringify(t.todos))})),y(this,"render",(function(){c.innerHTML="",a.innerText="",a.classList.remove("form-error"),t.sortAndSave(),t.todos.length>0?t.todos.forEach((function(e){var r=document.createElement("li");r.id=e.index,r.className="todo-item",r.setAttribute("draggable",!0),r.addEventListener("dragstart",(function(){r.classList.add("dragging")})),r.addEventListener("dragend",(function(){r.classList.remove("dragging")}));var n=document.createElement("input");n.setAttribute("type","checkbox"),n.id="todo-compleate",n.addEventListener("change",(function(e){t.onCompleate(e)}));var o=document.createElement("p");o.className="todo-des",o.innerText=e.description,e.completed&&(n.setAttribute("checked","yes"),o.classList.add("todo-compleated"));var i=document.createElement("button");i.className="btn-three-dot",i.innerHTML='<img src="'.concat(d,'" alt="...">'),i.addEventListener("click",(function(e){t.onClickTodoDes(e)})),r.append(n,o,i),c.appendChild(r)})):c.innerHTML='<p class="no-item">There is no todo to show! Please add a new one.</p>'})),y(this,"onSubmit",(function(){var e=i.value,r=o(e,!0,3,255,!1);if(!0===r.isError&&r.msg.length>=0)a.classList.add("form-error"),a.textContent=r.msg,i.classList.add("invalid");else{a.classList.remove("form-error"),a.textContent="",i.classList.remove("invalid"),i.value="";var n={description:e,completed:!1,index:t.todos.length+1||1};t.todos=[].concat(f(t.todos),[n]),t.render()}})),y(this,"delete",(function(e){t.todos=t.todos.filter((function(t){return t.index.toString()!==e})),t.render()})),y(this,"edit",(function(e){var r=e.target.value,n=o(r,!0,3,255,!1);if(!0===n.isError&&n.msg.length>0)a.classList.add("form-error"),a.textContent=n.msg,e.target.classList.add("invalid-edit");else{e.target.classList.remove("invalid-edit");var i=e.target.parentElement.id,s=f(t.todos),c=s.findIndex((function(e){return i===e.index.toString()}));c>=0&&(s[c].description=r),t.todos=f(s),t.render()}})),y(this,"onClickTodoDes",(function(e){var r=e.target.parentElement.parentElement,n=r.querySelector(".todo-des").innerText;r.innerHTML="";var o=document.createElement("input");o.setAttribute("type","checkbox"),o.id="todo-compleate",o.addEventListener("change",(function(e){t.onCompleate(e)}));var i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("value",n),i.className="todo-edit-input",i.addEventListener("keypress",(function(e){"Enter"===e.key?(e.preventDefault(),t.edit(e)):(a.classList.remove("form-error"),a.innerText="",e.target.classList.remove("invalid-edit"))}));var s=document.createElement("button");s.className="btn-delete",s.innerHTML='<img src="'.concat(u,'" alt="X">'),s.addEventListener("click",(function(){var e=r.id;t.delete(e)})),r.append(o,i,s)})),y(this,"onCompleate",(function(e){var r=e.target.parentElement.id,n=f(t.todos),o=n.findIndex((function(e){return r===e.index.toString()}));o>=0&&(n[o].completed=!n[o].completed),t.todos=f(n),t.render()})),y(this,"onFilterCompletedTodos",(function(){var e=f(t.todos);e=e.filter((function(e){return!0!==e.completed})),t.todos=f(e),t.render()})),localStorage.getItem("todos")?this.todos=JSON.parse(localStorage.getItem("todos")):this.todos=[]}));const E=r.p+"images/enter-24.png";var S=new b;i.addEventListener("keypress",(function(e){"Enter"===e.key?(e.preventDefault(),S.onSubmit()):(a.innerHTML="",a.classList.remove("form-error"),i.classList.remove("invalid"))})),s.addEventListener("click",(function(e){e.preventDefault(),S.onSubmit()})),l.addEventListener("click",(function(){S.onFilterCompletedTodos()})),c.addEventListener("dragover",(function(e){e.preventDefault();var t=function(e,t){return(r=e.querySelectorAll(".todo-item:not(.dragging)"),function(e){if(Array.isArray(e))return n(e)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reduce((function(e,r){var n=r.getBoundingClientRect(),o=t-n.top-n.height/2;return o<0&&o>e.offset?{offset:o,element:r}:e}),{offset:Number.NEGATIVE_INFINITY}).element;var r}(c,e.clientY),r=c.querySelector(".dragging");null==r?c.appendChild(r):c.insertBefore(r,t)})),window.onload=function(){S.render(),document.querySelector(".btn-submit").innerHTML="<img src='".concat(E,"' alt='submit'/>")}}},e=>{e(e.s=808)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0EsRUFBRTJCLGlCQUNGLElBQU1TLEVIS3VCLFNBQUNqRSxFQUFla0UsR0FHN0MsTyxFQUYrQmxFLEVBQWNFLGlCQUFpQiw2QixrbkJBRXBDaUUsUUFBTyxTQUFDQyxFQUFTakIsR0FFekMsSUFBTWtCLEVBQU1sQixFQUFLbUIsd0JBR1hDLEVBQVNMLEVBQUlHLEVBQUlHLElBQU1ILEVBQUlJLE9BQVMsRUFDMUMsT0FBSUYsRUFBUyxHQUFLQSxFQUFTSCxFQUFRRyxPQUMxQixDQUFFQSxPQUFBQSxFQUFRRyxRQUFTdkIsR0FFckJpQixDQUNULEdBQUcsQ0FBRUcsT0FBUUksT0FBT0Msb0JBQXFCRixRLEtBQzNDLENHbkJrQ0csQ0FBZ0I3RSxFQUFlNkIsRUFBRWlELFNBQzNEQyxFQUFXL0UsRUFBY0YsY0FBYyxhQUU3QixNQUFaaUYsRUFDRi9FLEVBQWNzQyxZQUFZeUMsR0FFMUIvRSxFQUFjZ0YsYUFBYUQsRUFBVWQsRUFFekMsSUFHQWdCLE9BQU9DLE9BQVMsV0FDZDdFLEVBQU1xQyxTQUNOL0MsU0FBU0csY0FBYyxlQUFla0IsVUFBWSxhQUFILE9BQWdCbUUsRUFBUyxtQkFDMUUsQyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvbW9kdWxlcy91dGlscy5qcyIsIndlYnBhY2s6Ly90by1kby1saXN0Ly4vc3JjL21vZHVsZXMvZG9tU2VsZWN0b3IuanMiLCJ3ZWJwYWNrOi8vdG8tZG8tbGlzdC8uL3NyYy9tb2R1bGVzL3RvZG9zLmpzIiwid2VicGFjazovL3RvLWRvLWxpc3QvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHZhbGlkYXRlRm9ybSA9IChcbiAgc3RyLCByZXF1aXJlZCA9IGZhbHNlLCBtaW5MZW5ndGggPSAwLCBtYXhMZW5ndGggPSAwLCBzcGVjaWFsQ2hhciA9IHRydWUsXG4pID0+IHtcbiAgbGV0IGlzRXJyb3IgPSBmYWxzZTtcbiAgbGV0IG1zZyA9ICcnO1xuICBzdHIgPSBzdHIudHJpbSgpO1xuICBjb25zdCBsZW4gPSBzdHIubGVuZ3RoO1xuXG4gIGlmIChyZXF1aXJlZCkge1xuICAgIGlmIChzdHIubGVuZ3RoIDw9IDApIHtcbiAgICAgIGlzRXJyb3IgPSB0cnVlO1xuICAgICAgbXNnID0gJ1RoaXMgZmllbGQgaXMgUmVxdWlyZWQhJztcbiAgICAgIHJldHVybiB7IGlzRXJyb3IsIG1zZyB9O1xuICAgIH1cbiAgfVxuXG4gIGlmIChtaW5MZW5ndGggPiAwKSB7XG4gICAgaWYgKGxlbiA8IG1pbkxlbmd0aCkge1xuICAgICAgaXNFcnJvciA9IHRydWU7XG4gICAgICBtc2cgPSBgVGhlIG1pbiBjaGFyYWN0ZXIgbGVuZ3RoIG9mIHRoaXMgZmllbGQgaXMgJHttaW5MZW5ndGh9YDtcbiAgICAgIHJldHVybiB7IGlzRXJyb3IsIG1zZyB9O1xuICAgIH1cbiAgfVxuXG4gIGlmIChtYXhMZW5ndGggPiAwKSB7XG4gICAgaWYgKGxlbiA+IG1heExlbmd0aCkge1xuICAgICAgaXNFcnJvciA9IHRydWU7XG4gICAgICBtc2cgPSBgVGhlIG1heCBjaGFyYWN0ZXIgbGVuZ3RoIG9mIHRoaXMgZmllbGQgaXMgJHttYXhMZW5ndGh9YDtcbiAgICAgIHJldHVybiB7IGlzRXJyb3IsIG1zZyB9O1xuICAgIH1cbiAgfVxuXG4gIGlmICghc3BlY2lhbENoYXIpIHtcbiAgICBjb25zdCBuZXdTdHIgPSBzdHIucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgICBjb25zdCByZSA9IC9eW0EtWmEtel1bQS1aYS16MC05LV8uXSokLztcbiAgICBpZiAoIXJlLnRlc3QobmV3U3RyKSkge1xuICAgICAgaXNFcnJvciA9IHRydWU7XG4gICAgICBtc2cgPSAnVGhpcyBmaWVsZCBpcyBvbmx5IGFsbG93IEEtejAtOV8uLSBjaGFyYWN0ZXJzIGFuZCBhbHNvIGZpcnN0IGNoYXJhY3RlciBzaG91bGQgYmUgQS16JztcbiAgICAgIHJldHVybiB7IGlzRXJyb3IsIG1zZyB9O1xuICAgIH1cbiAgfVxuICByZXR1cm4geyBpc0Vycm9yLCBtc2cgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRBZnRlckVsZW1lbnQgPSAodG9kb0NvbnRhaW5lciwgeSkgPT4ge1xuICBjb25zdCBkcmFnRmlsdGVyRWxlbWVudHMgPSBbLi4udG9kb0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudG9kby1pdGVtOm5vdCguZHJhZ2dpbmcpJyldO1xuXG4gIHJldHVybiBkcmFnRmlsdGVyRWxlbWVudHMucmVkdWNlKChuZWFyZXN0LCBpdGVtKSA9PiB7XG4gICAgLy8gZ2V0IHRoZSBib3ggY29udGVudFxuICAgIGNvbnN0IGJveCA9IGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAvLyBjYWxjdWxhdGUgdGhlIG9mZnNldFxuICAgIGNvbnN0IG9mZnNldCA9IHkgLSBib3gudG9wIC0gYm94LmhlaWdodCAvIDI7XG4gICAgaWYgKG9mZnNldCA8IDAgJiYgb2Zmc2V0ID4gbmVhcmVzdC5vZmZzZXQpIHtcbiAgICAgIHJldHVybiB7IG9mZnNldCwgZWxlbWVudDogaXRlbSB9O1xuICAgIH1cbiAgICByZXR1cm4gbmVhcmVzdDtcbiAgfSwgeyBvZmZzZXQ6IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSB9KS5lbGVtZW50O1xufTsiLCJleHBvcnQgY29uc3QgZm9ybUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJyk7XG5leHBvcnQgY29uc3Qgc2hvd01zZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kaXNwbGF5LW1lc3NhZ2UnKTtcbmV4cG9ydCBjb25zdCBidG5TdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuLXN1Ym1pdCcpO1xuZXhwb3J0IGNvbnN0IHRvZG9Db250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3JvdXAtdG9kby1pdGVtcycpO1xuZXhwb3J0IGNvbnN0IHRvZG9JdGVtc0RlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2RvLWRlcycpO1xuZXhwb3J0IGNvbnN0IGZpbHRlckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG4tY2xlYXItYWxsJyk7IiwiaW1wb3J0IHsgdmFsaWRhdGVGb3JtIH0gZnJvbSAnLi91dGlscy5qcyc7XG5pbXBvcnQgeyB0b2RvQ29udGFpbmVyLCBmb3JtSW5wdXQsIHNob3dNc2cgfSBmcm9tICcuL2RvbVNlbGVjdG9yLmpzJztcblxuaW1wb3J0IHRocmVlRG90SWNvbiBmcm9tICcuLi9Bc3NldHMvdGhyZWUtZG90LTI0LnBuZyc7XG5pbXBvcnQgZGVsZXRlSWNvbiBmcm9tICcuLi9Bc3NldHMvdHJhc2gtMjQucG5nJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9kb3Mge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RvZG9zJykpIHtcbiAgICAgIHRoaXMudG9kb3MgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2RvcycpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50b2RvcyA9IFtdO1xuICAgIH1cbiAgfVxuXG4gIHNvcnRBbmRTYXZlID0gKCkgPT4ge1xuICAgIGNvbnN0IHRvZG9BcnIgPSBbLi4udGhpcy50b2Rvc107XG4gICAgLy8gc29ydGluZyB0aGUgbGlzdFxuICAgIHRvZG9BcnIuc29ydCgoYSwgYikgPT4ge1xuICAgICAgaWYgKGEuaW5kZXggPiBiLmluZGV4KSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfSBpZiAoYS5pbmRleCA8IGIuaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgcmV0dXJuIDA7XG4gICAgfSk7XG5cbiAgICAvLyByZWFycmFuZ2UgdGhlIGluZGV4XG4gICAgbGV0IGluZGV4ID0gMDtcbiAgICB0b2RvQXJyLmZvckVhY2goKHRvZG8pID0+IHtcbiAgICAgIGluZGV4ICs9IDE7XG4gICAgICB0b2RvLmluZGV4ID0gaW5kZXg7XG4gICAgfSk7XG5cbiAgICB0aGlzLnRvZG9zID0gWy4uLnRvZG9BcnJdO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2RvcycsIEpTT04uc3RyaW5naWZ5KHRoaXMudG9kb3MpKTtcbiAgfVxuXG4gIC8vIFJlbmRlciB0b2RvIGxpc3RcbiAgcmVuZGVyID0gKCkgPT4ge1xuICAgIHRvZG9Db250YWluZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgc2hvd01zZy5pbm5lclRleHQgPSAnJztcbiAgICBzaG93TXNnLmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm0tZXJyb3InKTtcbiAgICB0aGlzLnNvcnRBbmRTYXZlKCk7XG4gICAgaWYgKHRoaXMudG9kb3MubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy50b2Rvcy5mb3JFYWNoKCh0b2RvKSA9PiB7XG4gICAgICAvLyBjcmVhdGUgdG9kbyBpdGVtXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgdG9kb0l0ZW0uaWQgPSB0b2RvLmluZGV4O1xuICAgICAgICB0b2RvSXRlbS5jbGFzc05hbWUgPSAndG9kby1pdGVtJztcbiAgICAgICAgdG9kb0l0ZW0uc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCB0cnVlKTtcblxuICAgICAgICAvLyBkcmFnIGFuZCBkcm9wIGZ1bmN0aW9uO1xuICAgICAgICB0b2RvSXRlbS5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCAoKSA9PiB7XG4gICAgICAgICAgdG9kb0l0ZW0uY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdG9kb0l0ZW0uYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsICgpID0+IHtcbiAgICAgICAgICB0b2RvSXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnZ2luZycpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyB0b2RvIGNoZWNrYm94XG4gICAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKCd0eXBlJywgJ2NoZWNrYm94Jyk7XG4gICAgICAgIGNoZWNrYm94LmlkID0gJ3RvZG8tY29tcGxlYXRlJztcblxuICAgICAgICBjaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgICAgICAgIHRoaXMub25Db21wbGVhdGUoZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHRvZG8gZGVzY3JpcHRpb25cbiAgICAgICAgY29uc3QgdG9kb0RlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgdG9kb0Rlcy5jbGFzc05hbWUgPSAndG9kby1kZXMnO1xuICAgICAgICB0b2RvRGVzLmlubmVyVGV4dCA9IHRvZG8uZGVzY3JpcHRpb247XG5cbiAgICAgICAgaWYgKHRvZG8uY29tcGxldGVkKSB7XG4gICAgICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKCdjaGVja2VkJywgJ3llcycpO1xuICAgICAgICAgIHRvZG9EZXMuY2xhc3NMaXN0LmFkZCgndG9kby1jb21wbGVhdGVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0b2RvIFRocmVlIGRvdCBidXR0b25cbiAgICAgICAgY29uc3QgdGhyZWVEb3RCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgICAgdGhyZWVEb3RCdXR0b24uY2xhc3NOYW1lID0gJ2J0bi10aHJlZS1kb3QnO1xuICAgICAgICB0aHJlZURvdEJ1dHRvbi5pbm5lckhUTUwgPSBgPGltZyBzcmM9XCIke3RocmVlRG90SWNvbn1cIiBhbHQ9XCIuLi5cIj5gO1xuXG4gICAgICAgIC8vIGFkZCBldmVudCBvbiB0aHJlZSBpY29uIGZvciBlZGl0IGFuZCBkZWxldGUuXG4gICAgICAgIHRocmVlRG90QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgICB0aGlzLm9uQ2xpY2tUb2RvRGVzKGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBcHBlbmQgYWxsIHRoZSB0b2RvIGVsZW1lbnRzIGluc2lkZSB0aGUgdG9kb0l0ZW1zXG4gICAgICAgIHRvZG9JdGVtLmFwcGVuZChjaGVja2JveCwgdG9kb0RlcywgdGhyZWVEb3RCdXR0b24pO1xuXG4gICAgICAgIC8vIGFwcGVudCB0aGUgdG9kbyBpdGVtIGluc2lkZSB0b2RvQ29udGFpbmVyXG4gICAgICAgIHRvZG9Db250YWluZXIuYXBwZW5kQ2hpbGQodG9kb0l0ZW0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRvZG9Db250YWluZXIuaW5uZXJIVE1MID0gJzxwIGNsYXNzPVwibm8taXRlbVwiPlRoZXJlIGlzIG5vIHRvZG8gdG8gc2hvdyEgUGxlYXNlIGFkZCBhIG5ldyBvbmUuPC9wPic7XG4gICAgfVxuICB9XG5cbiAgLy8gb25TdWJtaXQgbWV0aG9kXG4gIG9uU3VibWl0ID0gKCkgPT4ge1xuICAgIC8vIFZhbGlkYXRlIHRoZSBmb3JtXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBmb3JtSW5wdXQudmFsdWU7XG4gICAgY29uc3QgcmVxdWlyZWQgPSB0cnVlO1xuICAgIGNvbnN0IG1pbkxlbmd0aCA9IDM7XG4gICAgY29uc3QgbWF4TGVuZ3RoID0gMjU1O1xuICAgIGNvbnN0IHNwZWNpYWxDaGFyID0gZmFsc2U7XG4gICAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRm9ybShkZXNjcmlwdGlvbiwgcmVxdWlyZWQsIG1pbkxlbmd0aCwgbWF4TGVuZ3RoLCBzcGVjaWFsQ2hhcik7XG5cbiAgICAvLyBDaGVjayBpZiBmb3JtIGhhcyBlcnJvciBvciBub3RcblxuICAgIGlmIChpc1ZhbGlkLmlzRXJyb3IgPT09IHRydWUgJiYgaXNWYWxpZC5tc2cubGVuZ3RoID49IDApIHtcbiAgICAgIHNob3dNc2cuY2xhc3NMaXN0LmFkZCgnZm9ybS1lcnJvcicpO1xuICAgICAgc2hvd01zZy50ZXh0Q29udGVudCA9IGlzVmFsaWQubXNnO1xuICAgICAgZm9ybUlucHV0LmNsYXNzTGlzdC5hZGQoJ2ludmFsaWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gaWYgZm9ybSBpcyBlbXB0eSBhZGQgYSBuZXcgdG9kb1xuICAgICAgc2hvd01zZy5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtLWVycm9yJyk7XG4gICAgICBzaG93TXNnLnRleHRDb250ZW50ID0gJyc7XG4gICAgICBmb3JtSW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnaW52YWxpZCcpO1xuICAgICAgZm9ybUlucHV0LnZhbHVlID0gJyc7XG4gICAgICBjb25zdCBpbmRleCA9IHRoaXMudG9kb3MubGVuZ3RoICsgMSB8fCAxO1xuICAgICAgY29uc3QgdG9kbyA9IHtcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgIGluZGV4LFxuICAgICAgfTtcbiAgICAgIHRoaXMudG9kb3MgPSBbLi4udGhpcy50b2RvcywgdG9kb107XG4gICAgICAvLyByZW5kZXIgdGhlIG5ldyB0b2RvcyBvbiB0aGUgZG9tXG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbiAgfVxuXG4gIGRlbGV0ZSA9IChpbmRleCkgPT4ge1xuICAgIHRoaXMudG9kb3MgPSB0aGlzLnRvZG9zLmZpbHRlcigodCkgPT4gdC5pbmRleC50b1N0cmluZygpICE9PSBpbmRleCk7XG4gICAgdGhpcy5yZW5kZXIoKTtcbiAgfVxuXG4gIC8vIGVkaXQgdG9kb1xuICBlZGl0ID0gKGUpID0+IHtcbiAgICBjb25zdCB7IHZhbHVlIH0gPSBlLnRhcmdldDtcblxuICAgIC8vIHZhbGlkYXRlIGZvcm1cbiAgICBjb25zdCByZXF1aXJlZCA9IHRydWU7XG4gICAgY29uc3QgbWluTGVuZ3RoID0gMztcbiAgICBjb25zdCBtYXhMZW5ndGggPSAyNTU7XG4gICAgY29uc3Qgc3BlY2lhbENoYXIgPSBmYWxzZTtcbiAgICBjb25zdCBpc1ZhbGlkID0gdmFsaWRhdGVGb3JtKHZhbHVlLCByZXF1aXJlZCwgbWluTGVuZ3RoLCBtYXhMZW5ndGgsIHNwZWNpYWxDaGFyKTtcbiAgICBpZiAoaXNWYWxpZC5pc0Vycm9yID09PSB0cnVlICYmIGlzVmFsaWQubXNnLmxlbmd0aCA+IDApIHtcbiAgICAgIHNob3dNc2cuY2xhc3NMaXN0LmFkZCgnZm9ybS1lcnJvcicpO1xuICAgICAgc2hvd01zZy50ZXh0Q29udGVudCA9IGlzVmFsaWQubXNnO1xuICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnaW52YWxpZC1lZGl0Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmFsaWQtZWRpdCcpO1xuICAgICAgY29uc3QgaW5kZXggPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmlkO1xuICAgICAgY29uc3QgbmV3QXJyID0gWy4uLnRoaXMudG9kb3NdO1xuICAgICAgY29uc3QgaW5keCA9IG5ld0Fyci5maW5kSW5kZXgoKGl0ZW0pID0+IGluZGV4ID09PSBpdGVtLmluZGV4LnRvU3RyaW5nKCkpO1xuICAgICAgaWYgKGluZHggPj0gMCkge1xuICAgICAgICBuZXdBcnJbaW5keF0uZGVzY3JpcHRpb24gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHRoaXMudG9kb3MgPSBbLi4ubmV3QXJyXTtcbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfVxuICB9XG5cbiAgLy8gb25DbGlja0RlcyBlbmVudCBtZXRob2RcbiAgb25DbGlja1RvZG9EZXMgPSAoZSkgPT4ge1xuICAgIC8vIHRhcmdldC5vdXRlckhUTUwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xuICAgIGNvbnN0IHBhcmVudCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICBjb25zdCBnZXRUb3RvZGVzID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RvLWRlcycpLmlubmVyVGV4dDtcbiAgICBwYXJlbnQuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAvLyB0b2RvIGNoZWNrYm94XG4gICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGNoZWNrYm94LnNldEF0dHJpYnV0ZSgndHlwZScsICdjaGVja2JveCcpO1xuICAgIGNoZWNrYm94LmlkID0gJ3RvZG8tY29tcGxlYXRlJztcblxuICAgIGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgICB0aGlzLm9uQ29tcGxlYXRlKGUpO1xuICAgIH0pO1xuXG4gICAgLy8gdG9kbyBkZXNjcmlwdGlvblxuICAgIGNvbnN0IHRvZG9FZGl0SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIHRvZG9FZGl0SW5wdXQuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKTtcbiAgICB0b2RvRWRpdElucHV0LnNldEF0dHJpYnV0ZSgndmFsdWUnLCBnZXRUb3RvZGVzKTtcbiAgICB0b2RvRWRpdElucHV0LmNsYXNzTmFtZSA9ICd0b2RvLWVkaXQtaW5wdXQnO1xuXG4gICAgLy8gQWRkIGV2ZW50IG9uIGtleXByZXNzIGluIHRoZSB0ZXh0YXJlYVxuICAgIHRvZG9FZGl0SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5lZGl0KGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2hvd01zZy5jbGFzc0xpc3QucmVtb3ZlKCdmb3JtLWVycm9yJyk7XG4gICAgICAgIHNob3dNc2cuaW5uZXJUZXh0ID0gJyc7XG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoJ2ludmFsaWQtZWRpdCcpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gdG9kbyBEZWxldGUgZG90IGJ1dHRvblxuICAgIGNvbnN0IGRlbGV0ZVRvZG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBkZWxldGVUb2RvLmNsYXNzTmFtZSA9ICdidG4tZGVsZXRlJztcbiAgICBkZWxldGVUb2RvLmlubmVySFRNTCA9IGA8aW1nIHNyYz1cIiR7ZGVsZXRlSWNvbn1cIiBhbHQ9XCJYXCI+YDtcblxuICAgIC8vIGFkZGluZyBldmVudCBvbiBkZWxldGUgaWNvblxuICAgIGRlbGV0ZVRvZG8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbmRleCA9IHBhcmVudC5pZDtcbiAgICAgIHRoaXMuZGVsZXRlKGluZGV4KTtcbiAgICB9KTtcblxuICAgIHBhcmVudC5hcHBlbmQoY2hlY2tib3gsIHRvZG9FZGl0SW5wdXQsIGRlbGV0ZVRvZG8pO1xuICB9XG5cbiAgb25Db21wbGVhdGUgPSAoZSkgPT4ge1xuICAgIGNvbnN0IGluZGV4ID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5pZDtcbiAgICBjb25zdCBuZXdBcnIgPSBbLi4udGhpcy50b2Rvc107XG4gICAgY29uc3QgaW5keCA9IG5ld0Fyci5maW5kSW5kZXgoKGl0ZW0pID0+IGluZGV4ID09PSBpdGVtLmluZGV4LnRvU3RyaW5nKCkpO1xuICAgIGlmIChpbmR4ID49IDApIHtcbiAgICAgIG5ld0FycltpbmR4XS5jb21wbGV0ZWQgPSAhbmV3QXJyW2luZHhdLmNvbXBsZXRlZDtcbiAgICB9XG4gICAgdGhpcy50b2RvcyA9IFsuLi5uZXdBcnJdO1xuICAgIHRoaXMucmVuZGVyKCk7XG4gIH1cblxuICBvbkZpbHRlckNvbXBsZXRlZFRvZG9zID0gKCkgPT4ge1xuICAgIGxldCBuZXdBcnIgPSBbLi4udGhpcy50b2Rvc107XG4gICAgbmV3QXJyID0gbmV3QXJyLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5jb21wbGV0ZWQgIT09IHRydWUpO1xuICAgIHRoaXMudG9kb3MgPSBbLi4ubmV3QXJyXTtcbiAgICB0aGlzLnJlbmRlcigpO1xuICB9XG59IiwiaW1wb3J0ICcuL3N0eWxlLmNzcyc7XG5pbXBvcnQgVG9kb3MgZnJvbSAnLi9tb2R1bGVzL3RvZG9zLmpzJztcbmltcG9ydCB7XG4gIGZvcm1JbnB1dCwgYnRuU3VibWl0LCBzaG93TXNnLCBmaWx0ZXJCdXR0b24sIHRvZG9Db250YWluZXIsXG59IGZyb20gJy4vbW9kdWxlcy9kb21TZWxlY3Rvci5qcyc7XG5cbi8vIEltcG9ydCBuZWNlc3NhcnkgYXNzZXRzIGZvcm0gc291cmNlXG5pbXBvcnQgZW50ZXJJY29uIGZyb20gJy4vQXNzZXRzL2VudGVyLTI0LnBuZyc7XG5pbXBvcnQgeyBnZXRBZnRlckVsZW1lbnQgfSBmcm9tICcuL21vZHVsZXMvdXRpbHMuanMnO1xuXG4vLyBJbml0aWFsaXplIHRoZSB0b2Rvc1xuY29uc3QgdG9kb3MgPSBuZXcgVG9kb3MoKTtcblxuLy8gdG9kbyBzdWJtaXQgZXZlbnQgdXNpbmcgRW50ZXIgYnV0dG9uLlxuZm9ybUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgKGUpID0+IHtcbiAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRvZG9zLm9uU3VibWl0KCk7XG4gIH0gZWxzZSB7XG4gICAgc2hvd01zZy5pbm5lckhUTUwgPSAnJztcbiAgICBzaG93TXNnLmNsYXNzTGlzdC5yZW1vdmUoJ2Zvcm0tZXJyb3InKTtcbiAgICBmb3JtSW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnaW52YWxpZCcpO1xuICB9XG59KTtcblxuLy8gdG9kbyBzdWJtaXQgZXZlbnQgdXNpbmcgc3VibWl0IGJ1dHRvblxuYnRuU3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICB0b2Rvcy5vblN1Ym1pdCgpO1xufSk7XG5cbi8vIGZpbHRlciBhbGwgY29tcGxldGVkIGxpc3Q7XG5maWx0ZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIHRvZG9zLm9uRmlsdGVyQ29tcGxldGVkVG9kb3MoKTtcbn0pO1xuXG4vLyBkcmFnIG92ZXIgZW5lbnQ7XG50b2RvQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBnZXRBZnRlckVsZW1lbnRQb3NpdGlvbiA9IGdldEFmdGVyRWxlbWVudCh0b2RvQ29udGFpbmVyLCBlLmNsaWVudFkpO1xuICBjb25zdCBkcmFnZ2luZyA9IHRvZG9Db250YWluZXIucXVlcnlTZWxlY3RvcignLmRyYWdnaW5nJyk7XG5cbiAgaWYgKGRyYWdnaW5nID09IG51bGwpIHtcbiAgICB0b2RvQ29udGFpbmVyLmFwcGVuZENoaWxkKGRyYWdnaW5nKTtcbiAgfSBlbHNlIHtcbiAgICB0b2RvQ29udGFpbmVyLmluc2VydEJlZm9yZShkcmFnZ2luZywgZ2V0QWZ0ZXJFbGVtZW50UG9zaXRpb24pO1xuICB9XG59KTtcblxuLy8gTG9hZCB0aGUgdG9kbyBsaXN0IG9uIHRoZSBmbHkuXG53aW5kb3cub25sb2FkID0gKCkgPT4ge1xuICB0b2Rvcy5yZW5kZXIoKTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ0bi1zdWJtaXQnKS5pbm5lckhUTUwgPSBgPGltZyBzcmM9JyR7ZW50ZXJJY29ufScgYWx0PSdzdWJtaXQnLz5gO1xufTtcbiJdLCJuYW1lcyI6WyJ2YWxpZGF0ZUZvcm0iLCJzdHIiLCJyZXF1aXJlZCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsInNwZWNpYWxDaGFyIiwiaXNFcnJvciIsIm1zZyIsImxlbiIsInRyaW0iLCJsZW5ndGgiLCJuZXdTdHIiLCJyZXBsYWNlIiwicmUiLCJ0ZXN0IiwiZm9ybUlucHV0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNob3dNc2ciLCJxdWVyeVNlbGVjdG9yIiwiYnRuU3VibWl0IiwidG9kb0NvbnRhaW5lciIsImZpbHRlckJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJUb2RvcyIsInRvZG9BcnIiLCJ0b2RvcyIsInNvcnQiLCJhIiwiYiIsImluZGV4IiwiZm9yRWFjaCIsInRvZG8iLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImlubmVySFRNTCIsImlubmVyVGV4dCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInNvcnRBbmRTYXZlIiwidG9kb0l0ZW0iLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJjbGFzc05hbWUiLCJzZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwiYWRkIiwiY2hlY2tib3giLCJlIiwib25Db21wbGVhdGUiLCJ0b2RvRGVzIiwiZGVzY3JpcHRpb24iLCJjb21wbGV0ZWQiLCJ0aHJlZURvdEJ1dHRvbiIsInRocmVlRG90SWNvbiIsIm9uQ2xpY2tUb2RvRGVzIiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJ2YWx1ZSIsImlzVmFsaWQiLCJ0ZXh0Q29udGVudCIsInJlbmRlciIsImZpbHRlciIsInQiLCJ0b1N0cmluZyIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJuZXdBcnIiLCJpbmR4IiwiZmluZEluZGV4IiwiaXRlbSIsInBhcmVudCIsImdldFRvdG9kZXMiLCJ0b2RvRWRpdElucHV0Iiwia2V5IiwicHJldmVudERlZmF1bHQiLCJlZGl0IiwiZGVsZXRlVG9kbyIsImRlbGV0ZUljb24iLCJnZXRJdGVtIiwidGhpcyIsInBhcnNlIiwib25TdWJtaXQiLCJvbkZpbHRlckNvbXBsZXRlZFRvZG9zIiwiZ2V0QWZ0ZXJFbGVtZW50UG9zaXRpb24iLCJ5IiwicmVkdWNlIiwibmVhcmVzdCIsImJveCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm9mZnNldCIsInRvcCIsImhlaWdodCIsImVsZW1lbnQiLCJOdW1iZXIiLCJORUdBVElWRV9JTkZJTklUWSIsImdldEFmdGVyRWxlbWVudCIsImNsaWVudFkiLCJkcmFnZ2luZyIsImluc2VydEJlZm9yZSIsIndpbmRvdyIsIm9ubG9hZCIsImVudGVySWNvbiJdLCJzb3VyY2VSb290IjoiIn0=